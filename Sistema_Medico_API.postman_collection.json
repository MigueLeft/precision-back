{
	"info": {
		"_postman_id": "12345678-1234-5678-9012-123456789012",
		"name": "Sistema M√©dico NestJS - API Collection",
		"description": "Colecci√≥n completa de endpoints para el sistema m√©dico con pruebas de estados y transiciones",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "üë• Users Management",
			"item": [
				{
					"name": "Create User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{bearerToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Dr. Juan P√©rez\",\n  \"email\": \"juan.perez@hospital.com\",\n  \"password\": \"SecurePass123!\",\n  \"active\": true\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Response has user data\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.success).to.be.true;",
									"    pm.expect(jsonData.data).to.have.property('id');",
									"    pm.globals.set(\"userId\", jsonData.data.id);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Users",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{bearerToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/users?page=1&limit=10&search=juan&active=true",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "10"
								},
								{
									"key": "search",
									"value": "juan"
								},
								{
									"key": "active",
									"value": "true"
								}
							]
						}
					}
				},
				{
					"name": "Get User by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{bearerToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					}
				},
				{
					"name": "Update User",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{bearerToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Dr. Juan Carlos P√©rez\",\n  \"active\": true\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					}
				}
			]
		},
		{
			"name": "üë®‚Äç‚öïÔ∏è Medics Management",
			"item": [
				{
					"name": "Create Medic",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"firstName\": \"Dr. Carlos\",\n  \"lastName\": \"Rodr√≠guez\",\n  \"email\": \"carlos.rodriguez@hospital.com\",\n  \"phone\": \"+1234567890\",\n  \"specialty\": \"Cardiolog√≠a\",\n  \"licenseNumber\": \"MED-12345\",\n  \"yearsOfExperience\": 10,\n  \"education\": \"Universidad Nacional - Medicina\",\n  \"certifications\": [\"Cardiolog√≠a Intervencionista\", \"Ecocardiograf√≠a\"],\n  \"languagesSpoken\": [\"Espa√±ol\", \"Ingl√©s\"],\n  \"consultationFee\": 150.00,\n  \"active\": true\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/medics",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"medics"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.globals.set(\"medicId\", jsonData.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Medics",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/medics?specialty=Cardiolog√≠a&active=true",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"medics"
							],
							"query": [
								{
									"key": "specialty",
									"value": "Cardiolog√≠a"
								},
								{
									"key": "active",
									"value": "true"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "üè• Patients Management",
			"item": [
				{
					"name": "Create Patient",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"firstName\": \"Mar√≠a\",\n  \"lastName\": \"Gonz√°lez\",\n  \"email\": \"maria.gonzalez@email.com\",\n  \"phone\": \"+1234567890\",\n  \"dateOfBirth\": \"1990-05-15\",\n  \"gender\": \"female\",\n  \"address\": \"Calle 123, Ciudad\",\n  \"emergencyContact\": \"Juan Gonz√°lez - +0987654321\",\n  \"medicalHistory\": \"Sin antecedentes relevantes\",\n  \"active\": true\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/patients",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"patients"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.globals.set(\"patientId\", jsonData.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get All Patients",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/patients?page=1&limit=10&search=mar√≠a&gender=female",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"patients"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "10"
								},
								{
									"key": "search",
									"value": "mar√≠a"
								},
								{
									"key": "gender",
									"value": "female"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "üìÖ Appointments Management",
			"item": [
				{
					"name": "Create Appointment - Pending",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"patientId\": \"{{patientId}}\",\n  \"medicId\": \"{{medicId}}\",\n  \"dateTime\": \"2024-12-15T10:00:00.000Z\",\n  \"appointmentType\": \"first_time\",\n  \"appointmentStatus\": \"pending\",\n  \"reason\": \"Consulta general\",\n  \"notes\": \"Primera consulta cardiol√≥gica\",\n  \"requiresFollowUp\": true,\n  \"followUpDate\": \"2024-12-22T10:00:00.000Z\",\n  \"followUpPriority\": \"NORMAL\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/appointments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"appointments"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.globals.set(\"appointmentId\", jsonData.data.id);",
									"    pm.test(\"Appointment status is pending\", function () {",
									"        pm.expect(jsonData.data.appointmentStatus).to.eql(\"pending\");",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Update Appointment - Pending to Scheduled",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"appointmentStatus\": \"scheduled\",\n  \"notes\": \"Cita confirmada y programada\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/appointments/{{appointmentId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"appointments",
								"{{appointmentId}}"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Appointment status is scheduled\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.appointmentStatus).to.eql(\"scheduled\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Update Appointment - Scheduled to Completed",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"appointmentStatus\": \"completed\",\n  \"notes\": \"Consulta realizada exitosamente. Paciente evaluado completamente.\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/appointments/{{appointmentId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"appointments",
								"{{appointmentId}}"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Appointment status is completed\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.appointmentStatus).to.eql(\"completed\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "‚ùå Invalid Transition - Completed to Pending",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"appointmentStatus\": \"pending\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/appointments/{{appointmentId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"appointments",
								"{{appointmentId}}"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400 (Invalid transition)\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Appointments by Status",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/appointments?appointmentStatus=completed&appointmentType=first_time",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"appointments"
							],
							"query": [
								{
									"key": "appointmentStatus",
									"value": "completed"
								},
								{
									"key": "appointmentType",
									"value": "first_time"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "üîÑ Patient Follow-up Management",
			"item": [
				{
					"name": "Create Follow-up - Pending",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"patientId\": \"{{patientId}}\",\n  \"originAppointmentId\": \"{{appointmentId}}\",\n  \"followUpType\": \"POST_CONSULTATION\",\n  \"status\": \"PENDING\",\n  \"priority\": \"NORMAL\",\n  \"scheduledContactDate\": \"2024-12-02T09:00:00.000Z\",\n  \"attemptCount\": 0,\n  \"maxAttempts\": 3,\n  \"notes\": \"Seguimiento post-consulta cardiol√≥gica\",\n  \"assignedTo\": \"{{userId}}\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/patient-follow",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"patient-follow"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.globals.set(\"followUpId\", jsonData.data.id);",
									"    pm.test(\"Follow-up status is PENDING\", function () {",
									"        pm.expect(jsonData.data.status).to.eql(\"PENDING\");",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Update Follow-up - Pending to In Progress",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"status\": \"IN_PROGRESS\",\n  \"notes\": \"Iniciando intentos de contacto\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/patient-follow/{{followUpId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"patient-follow",
								"{{followUpId}}"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Follow-up status is IN_PROGRESS\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.status).to.eql(\"IN_PROGRESS\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Pending Follow-ups",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/patient-follow/pending?priority=HIGH",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"patient-follow",
								"pending"
							],
							"query": [
								{
									"key": "priority",
									"value": "HIGH"
								}
							]
						}
					}
				},
				{
					"name": "Increment Attempt Count",
					"request": {
						"method": "PATCH",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/patient-follow/{{followUpId}}/increment-attempt",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"patient-follow",
								"{{followUpId}}",
								"increment-attempt"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Attempt count incremented\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.attemptCount).to.be.above(0);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "üìû Contact Attempts Management",
			"item": [
				{
					"name": "Create Contact Attempt - No Answer",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"followUpId\": \"{{followUpId}}\",\n  \"attemptNumber\": 1,\n  \"contactMethod\": \"PHONE\",\n  \"contactResult\": \"NO_ANSWER\",\n  \"contactDuration\": 0,\n  \"contactNotes\": \"Llamada no contestada, buz√≥n de voz\",\n  \"appointmentScheduled\": false\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/contact-attempt",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"contact-attempt"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.globals.set(\"contactAttemptId\", jsonData.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Create Contact Attempt - Successful",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"followUpId\": \"{{followUpId}}\",\n  \"attemptNumber\": 2,\n  \"contactMethod\": \"PHONE\",\n  \"contactResult\": \"SUCCESSFUL\",\n  \"contactDuration\": 180,\n  \"contactNotes\": \"Paciente contest√≥, program√≥ nueva cita\",\n  \"patientResponse\": \"Acepta cita de control en 2 semanas\",\n  \"appointmentScheduled\": true\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/contact-attempt",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"contact-attempt"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Contact result is SUCCESSFUL\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.contactResult).to.eql(\"SUCCESSFUL\");",
									"    pm.expect(jsonData.data.appointmentScheduled).to.be.true;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Successful Contact Attempts",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/contact-attempt/successful?appointmentScheduled=true",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"contact-attempt",
								"successful"
							],
							"query": [
								{
									"key": "appointmentScheduled",
									"value": "true"
								}
							]
						}
					}
				},
				{
					"name": "Get Failed Contact Attempts",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/contact-attempt/failed?contactMethod=PHONE",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"contact-attempt",
								"failed"
							],
							"query": [
								{
									"key": "contactMethod",
									"value": "PHONE"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "üÜò Rescue Directory Management",
			"item": [
				{
					"name": "Create Rescue Entry - Max Attempts Reached",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"patientId\": \"{{patientId}}\",\n  \"originalFollowUpId\": \"{{followUpId}}\",\n  \"rescueReason\": \"MAX_ATTEMPTS_REACHED\",\n  \"rescueCategory\": \"HIGH_VALUE\",\n  \"priority\": \"HIGH\",\n  \"lastContactDate\": \"2024-11-28T10:00:00.000Z\",\n  \"lastAttemptDate\": \"2024-11-30T16:00:00.000Z\",\n  \"totalPreviousAttempts\": 3,\n  \"rescueNotes\": \"Paciente no responde despu√©s de 3 intentos telef√≥nicos\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/rescue-directory",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"rescue-directory"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.globals.set(\"rescueId\", jsonData.data.id);",
									"    pm.test(\"Rescue status is ACTIVE\", function () {",
									"        pm.expect(jsonData.data.status).to.eql(\"ACTIVE\");",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Active Rescue Entries",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/rescue-directory/active?rescueCategory=HIGH_VALUE",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"rescue-directory",
								"active"
							],
							"query": [
								{
									"key": "rescueCategory",
									"value": "HIGH_VALUE"
								}
							]
						}
					}
				},
				{
					"name": "Get High Priority Rescue Entries",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/rescue-directory/high-priority",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"rescue-directory",
								"high-priority"
							]
						}
					}
				},
				{
					"name": "Get Critical Rescue Entries",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/rescue-directory/critical?rescueCategory=POST_SURGERY",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"rescue-directory",
								"critical"
							],
							"query": [
								{
									"key": "rescueCategory",
									"value": "POST_SURGERY"
								}
							]
						}
					}
				},
				{
					"name": "Reactivate Rescue Entry",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"reactivationNotes\": \"Paciente contactado exitosamente, acepta seguimiento\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/rescue-directory/{{rescueId}}/reactivate",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"rescue-directory",
								"{{rescueId}}",
								"reactivate"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Rescue status is REACTIVATED\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.status).to.eql(\"REACTIVATED\");",
									"    pm.expect(jsonData.data.reactivatedAt).to.not.be.null;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Archive Rescue Entry",
					"request": {
						"method": "PATCH",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/rescue-directory/{{rescueId}}/archive",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"rescue-directory",
								"{{rescueId}}",
								"archive"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Rescue status is ARCHIVED\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.status).to.eql(\"ARCHIVED\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "üîÑ Reschedules Management",
			"item": [
				{
					"name": "Create Reschedule - Pending",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"appointmentId\": \"{{appointmentId}}\",\n  \"previousDateTime\": \"2024-12-01T10:00:00.000Z\",\n  \"newDateTime\": \"2024-12-02T14:00:00.000Z\",\n  \"rescheduleReason\": \"patient_request\",\n  \"rescheduleStatus\": \"pending\",\n  \"requestedBy\": \"patient\",\n  \"requestedById\": \"{{userId}}\",\n  \"notes\": \"Paciente solicit√≥ cambio por compromisos laborales\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/reschedules",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"reschedules"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.globals.set(\"rescheduleId\", jsonData.data.id);",
									"    pm.test(\"Reschedule status is pending\", function () {",
									"        pm.expect(jsonData.data.rescheduleStatus).to.eql(\"pending\");",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Approve Reschedule",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"rescheduleStatus\": \"approved\",\n  \"approvedBy\": \"{{adminUserId}}\",\n  \"approvedAt\": \"2024-11-30T16:00:00.000Z\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/reschedules/{{rescheduleId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"reschedules",
								"{{rescheduleId}}"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Reschedule status is approved\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.rescheduleStatus).to.eql(\"approved\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Reject Reschedule",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"rescheduleStatus\": \"rejected\",\n  \"rejectedBy\": \"{{adminUserId}}\",\n  \"rejectedAt\": \"2024-11-30T16:00:00.000Z\",\n  \"rejectionReason\": \"No disponibilidad en horario solicitado\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/reschedules/{{rescheduleId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"reschedules",
								"{{rescheduleId}}"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Reschedule status is rejected\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.data.rescheduleStatus).to.eql(\"rejected\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "ü©∫ Consultations Management",
			"item": [
				{
					"name": "Create Consultation",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"appointmentId\": \"{{appointmentId}}\",\n  \"chiefComplaint\": \"Dolor de cabeza persistente\",\n  \"historyOfPresentIllness\": \"Paciente refiere dolor de cabeza de 3 d√≠as de evoluci√≥n\",\n  \"physicalExamination\": \"Presi√≥n arterial normal, sin signos neurol√≥gicos\",\n  \"diagnosis\": \"Cefalea tensional\",\n  \"treatment\": \"Analg√©sicos, descanso\",\n  \"prescriptions\": [\"Ibuprofeno 400mg cada 8 horas\"],\n  \"followUpInstructions\": \"Control en 1 semana si persisten s√≠ntomas\",\n  \"notes\": \"Paciente estresado por trabajo\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/consultations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"consultations"
							]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.globals.set(\"consultationId\", jsonData.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "üß™ Integration Tests - Complete Workflows",
			"item": [
				{
					"name": "üîÑ Complete Patient Journey",
					"item": [
						{
							"name": "Step 1 - Create Patient",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"firstName\": \"Ana\",\n  \"lastName\": \"Mart√≠nez\",\n  \"email\": \"ana.martinez@email.com\",\n  \"phone\": \"+1555666777\",\n  \"dateOfBirth\": \"1985-03-20\",\n  \"gender\": \"female\",\n  \"active\": true\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/patients",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"patients"
									]
								}
							},
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 201) {",
											"    var jsonData = pm.response.json();",
											"    pm.globals.set(\"integrationPatientId\", jsonData.data.id);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							]
						},
						{
							"name": "Step 2 - Create Appointment",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"patientId\": \"{{integrationPatientId}}\",\n  \"medicId\": \"{{medicId}}\",\n  \"dateTime\": \"2024-12-20T11:00:00.000Z\",\n  \"appointmentType\": \"first_time\",\n  \"appointmentStatus\": \"scheduled\",\n  \"reason\": \"Consulta de control\",\n  \"requiresFollowUp\": true\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/appointments",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"appointments"
									]
								}
							},
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 201) {",
											"    var jsonData = pm.response.json();",
											"    pm.globals.set(\"integrationAppointmentId\", jsonData.data.id);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							]
						},
						{
							"name": "Step 3 - Complete Appointment",
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"appointmentStatus\": \"completed\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/appointments/{{integrationAppointmentId}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"appointments",
										"{{integrationAppointmentId}}"
									]
								}
							}
						},
						{
							"name": "Step 4 - Create Follow-up",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"patientId\": \"{{integrationPatientId}}\",\n  \"originAppointmentId\": \"{{integrationAppointmentId}}\",\n  \"followUpType\": \"POST_CONSULTATION\",\n  \"scheduledContactDate\": \"2024-12-22T10:00:00.000Z\",\n  \"maxAttempts\": 3\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/patient-follow",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"patient-follow"
									]
								}
							},
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 201) {",
											"    var jsonData = pm.response.json();",
											"    pm.globals.set(\"integrationFollowUpId\", jsonData.data.id);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							]
						},
						{
							"name": "Step 5 - Failed Contact Attempt 1",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"followUpId\": \"{{integrationFollowUpId}}\",\n  \"attemptNumber\": 1,\n  \"contactMethod\": \"PHONE\",\n  \"contactResult\": \"NO_ANSWER\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/contact-attempt",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"contact-attempt"
									]
								}
							}
						},
						{
							"name": "Step 6 - Failed Contact Attempt 2",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"followUpId\": \"{{integrationFollowUpId}}\",\n  \"attemptNumber\": 2,\n  \"contactMethod\": \"PHONE\",\n  \"contactResult\": \"NO_ANSWER\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/contact-attempt",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"contact-attempt"
									]
								}
							}
						},
						{
							"name": "Step 7 - Failed Contact Attempt 3",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"followUpId\": \"{{integrationFollowUpId}}\",\n  \"attemptNumber\": 3,\n  \"contactMethod\": \"PHONE\",\n  \"contactResult\": \"NO_ANSWER\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/contact-attempt",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"contact-attempt"
									]
								}
							}
						},
						{
							"name": "Step 8 - Transfer to Rescue Directory",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"patientId\": \"{{integrationPatientId}}\",\n  \"originalFollowUpId\": \"{{integrationFollowUpId}}\",\n  \"rescueReason\": \"MAX_ATTEMPTS_REACHED\",\n  \"totalPreviousAttempts\": 3\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/rescue-directory",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"rescue-directory"
									]
								}
							},
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Patient journey completed successfully\", function () {",
											"    pm.response.to.have.status(201);",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.data.rescueReason).to.eql(\"MAX_ATTEMPTS_REACHED\");",
											"});"
										],
										"type": "text/javascript"
									}
								}
							]
						}
					]
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Pre-request script global",
					"console.log('Starting request to: ' + pm.request.url);"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global test script",
					"pm.test('Response time is acceptable', function () {",
					"    pm.expect(pm.response.responseTime).to.be.below(5000);",
					"});",
					"",
					"pm.test('Content-Type is application/json', function () {",
					"    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
					"});"
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:3001/api/v1",
			"type": "string"
		},
		{
			"key": "bearerToken",
			"value": "your_jwt_token_here",
			"type": "string"
		}
	]
}